# Proxmox LXC Role - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
3. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
4. [–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏](#–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ-—Ä–æ–ª–∏)
5. [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
6. [–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
7. [–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
8. [–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫](#–æ–±—Ä–∞–±–æ—Ç–∫–∞-–æ—à–∏–±–æ–∫)
9. [–°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#—Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
10. [–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)
11. [–£—á–∞—Å—Ç–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ](#—É—á–∞—Å—Ç–∏–µ-–≤-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ)

## –û–±–∑–æ—Ä

–†–æ–ª—å `proxmox_lxc` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º LXC –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ Proxmox Virtual Environment (PVE). –≠—Ç–∞ —Ä–æ–ª—å —Å–ª–µ–¥—É–µ—Ç –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º Ansible –∏ –≤–∫–ª—é—á–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É.

### –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**: –°–æ–∑–¥–∞–Ω–∏–µ LXC –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞–º–∏**: –ó–∞–≥—Ä—É–∑–∫–∞, –≤—ã–≥—Ä—É–∑–∫–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞–º–∏ –û–°
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–∏**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–ª–∏ DHCP –∞–¥—Ä–µ—Å–∞—Ü–∏–µ–π
- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏**: –í—ã–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ CPU, –ø–∞–º—è—Ç–∏, –¥–∏—Å–∫–∞ –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**: –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ç–∫–∞—Ç–∞
- **–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–µ–º–µ–π—Å—Ç–≤ Debian, RedHat –∏ SUSE
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Ansible**: 2.14 –∏–ª–∏ –≤—ã—à–µ
- **Python**: 3.8 –∏–ª–∏ –≤—ã—à–µ
- **Proxmox VE**: 7.0+ –∏–ª–∏ 8.0+
- **–¶–µ–ª–µ–≤–∞—è –û–°**: Debian, Ubuntu, RHEL, CentOS, openSUSE, SLES

### –ö–æ–ª–ª–µ–∫—Ü–∏–∏ Ansible

```yaml
collections:
  - community.general
```

### –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python

–†–æ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞–∫–µ—Ç—ã Python:
- `python3`
- `python3-pip`
- `python3-proxmoxer`

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π

```bash
ansible-galaxy collection install community.general
```

### 2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–æ–ª–∏

```bash
# –ò—Å–ø–æ–ª—å–∑—É—è ansible-galaxy
ansible-galaxy install local.proxmox_lxc

# –ò–ª–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone <repository-url> roles/proxmox_lxc
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

```bash
ansible-galaxy install -r requirements.yml
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–æ–ª–∏

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–ª–∞–¥–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-----|--------------|----------|
| `debug_mode` | bool | `true` | –í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ –æ—Ç–ª–∞–¥–∫–∏ |
| `debug_lang` | str | `"both"` | –Ø–∑—ã–∫ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ –≤—ã–≤–æ–¥–∞ (`english`, `russian`, `both`) |
| `debug_show_passwords` | bool | `false` | –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–∞—Ä–æ–ª–∏ –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏ (–ù–ï–ë–ï–ó–û–ü–ê–°–ù–û) |
| `validate_parameters` | bool | `true` | –í–∫–ª—é—á–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ |
| `strict_validation` | bool | `true` | –í–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º —Å—Ç—Ä–æ–≥–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ |

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-----|--------------|----------|
| `async_timeout` | int | `300` | –¢–∞–π–º–∞—É—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –≤ —Å–µ–∫—É–Ω–¥–∞—Ö |
| `retries` | int | `3` | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤ –¥–ª—è –Ω–µ—É–¥–∞—á–Ω—ã—Ö –∑–∞–¥–∞—á |
| `retry_delay` | int | `5` | –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–∞–º–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö |
| `log_file` | str | `"/var/log/ansible-proxmox-lxc.log"` | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∞ |

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ API Proxmox

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-----|-------------|----------|
| `pve_api_host` | str | –î–∞ | FQDN –∏–ª–∏ IP –∞–¥—Ä–µ—Å Proxmox API |
| `pve_node` | str | –î–∞ | –ò–º—è —É–∑–ª–∞ Proxmox –≥–¥–µ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω LXC –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä |
| `pve_api_user` | str | –ù–µ—Ç* | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Proxmox API |
| `pve_api_password` | str | –ù–µ—Ç* | –ü–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Proxmox API |
| `pve_api_token_id` | str | –ù–µ—Ç* | ID —Ç–æ–∫–µ–Ω–∞ Proxmox API |
| `pve_api_token_secret` | str | –ù–µ—Ç* | –°–µ–∫—Ä–µ—Ç —Ç–æ–∫–µ–Ω–∞ Proxmox API |
| `pve_validate_certs` | bool | `false` | –ü—Ä–æ–≤–µ—Ä—è—Ç—å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ Proxmox API |
| `pve_default_behavior` | str | `"compatibility"` | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –º–æ–¥—É–ª—è Proxmox –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |

*–¢—Ä–µ–±—É–µ—Ç—Å—è –ª–∏–±–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/–ø–∞—Ä–æ–ª—å, –ª–∏–±–æ —Ç–æ–∫–µ–Ω.

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-----|-------------|----------|
| `pve_hostname` | str | –î–∞ | –ò–º—è —Ö–æ—Å—Ç–∞ –¥–ª—è LXC –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `pve_lxc_vmid` | int | –ù–µ—Ç | VM ID –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω) |
| `pve_lxc_description` | str | –ù–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `pve_lxc_root_password` | str | –î–∞ | –ü–∞—Ä–æ–ª—å root –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `pve_lxc_root_authorized_pubkey` | str | –ù–µ—Ç | SSH –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è root |

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–∞ –û–°

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-----|--------------|----------|
| `pve_lxc_ostemplate_name` | str | - | –ò–º—è —à–∞–±–ª–æ–Ω–∞ –û–° |
| `pve_lxc_ostemplate_url` | str | - | URL –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —à–∞–±–ª–æ–Ω–∞ –û–° –µ—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| `pve_lxc_ostemplate_src` | str | - | –õ–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å –∫ –∏—Å—Ç–æ—á–Ω–∏–∫—É —à–∞–±–ª–æ–Ω–∞ –û–° |
| `pve_lxc_ostemplate_storage` | str | `"local"` | –ò–º—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤ –û–° |
| `pve_lxc_ostemplate_content_type` | str | `"vztmpl"` | –¢–∏–ø —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –¥–ª—è —à–∞–±–ª–æ–Ω–∞ –û–° |
| `pve_lxc_ostemplate_timeout` | int | `60` | –¢–∞–π–º–∞—É—Ç –æ–ø–µ—Ä–∞—Ü–∏–π —Å —à–∞–±–ª–æ–Ω–æ–º –≤ —Å–µ–∫—É–Ω–¥–∞—Ö |
| `pve_lxc_ostemplate_force` | bool | `true` | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —à–∞–±–ª–æ–Ω–∞ –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç |
| `pve_lxc_ostemplate_state` | str | `"present"` | –ñ–µ–ª–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —à–∞–±–ª–æ–Ω–∞ |

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-----|----------|
| `pve_lxc_cpu_cores` | int | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —è–¥–µ—Ä CPU |
| `pve_lxc_cpu_limit` | int | –õ–∏–º–∏—Ç CPU |
| `pve_lxc_cpu_units` | int | CPU units (–≤–µ—Å) |
| `pve_lxc_memory` | int | –†–∞–∑–º–µ—Ä –ø–∞–º—è—Ç–∏ –≤ –ú–ë |
| `pve_lxc_swap` | int | –†–∞–∑–º–µ—Ä swap –≤ –ú–ë |
| `pve_lxc_disk` | int | –†–∞–∑–º–µ—Ä –¥–∏—Å–∫–∞ –≤ –ì–ë |
| `pve_lxc_storage` | str | –ò–º—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–ª—è –¥–∏—Å–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |

### –ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-----|--------------|----------|
| `pve_onboot` | bool | `true` | –ó–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —É–∑–ª–∞ |
| `pve_lxc_unprivileged` | bool | `true` | –°–æ–∑–¥–∞—Ç—å –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä |
| `pve_lxc_force` | bool | `true` | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º |
| `pve_lxc_timeout` | int | `30` | –¢–∞–π–º–∞—É—Ç –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –≤ —Å–µ–∫—É–Ω–¥–∞—Ö |

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–∏

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-----|----------|
| `pve_lxc_nameserver` | str | DNS —Å–µ—Ä–≤–µ—Ä(—ã) |
| `pve_lxc_searchdomain` | str | DNS –¥–æ–º–µ–Ω –ø–æ–∏—Å–∫–∞ |
| `pve_lxc_ip_address` | str | IP –∞–¥—Ä–µ—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `pve_lxc_ip_mask` | str | –ú–∞—Å–∫–∞ –ø–æ–¥—Å–µ—Ç–∏ IP –¥–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `pve_lxc_ip_gateway` | str | IP —à–ª—é–∑ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `pve_lxc_mac_address` | str | MAC –∞–¥—Ä–µ—Å –¥–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `pve_lxc_net_interfaces` | list | –°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π —Å–µ—Ç–µ–≤—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ |

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-----|----------|
| `pve_lxc_features` | list | –§—É–Ω–∫—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (nesting, keyctl –∏ —Ç.–¥.) |
| `pve_lxc_hookscript` | str | –ü—É—Ç—å –∫ hook —Å–∫—Ä–∏–ø—Ç—É |
| `pve_lxc_mounts` | list | –°–ø–∏—Å–æ–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è |
| `pve_lxc_additional_configurations` | list | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ container.conf |
| `proxmox_config_dir` | str | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Proxmox |
| `proxmox_template_cache_dir` | str | –ü—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∫—ç—à–∞ —à–∞–±–ª–æ–Ω–æ–≤ |

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```yaml
- hosts: proxmox_nodes
  roles:
    - role: proxmox_lxc
      vars:
        pve_api_host: "pve.example.com"
        pve_node: "pve-node-01"
        pve_hostname: "web-server"
        pve_lxc_root_password: "{{ vault_root_password }}"
        pve_lxc_ostemplate_name: "debian-11-standard_11.7-1_amd64.tar.gz"
        pve_lxc_cpu_cores: 2
        pve_lxc_memory: 1024
        pve_lxc_disk: 20
        pve_lxc_ip_address: "192.168.1.100"
```

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```yaml
- hosts: proxmox_nodes
  roles:
    - role: proxmox_lxc
      vars:
        pve_api_host: "{{ proxmox_api_host }}"
        pve_node: "{{ proxmox_node }}"
        pve_hostname: "{{ item.hostname }}"
        pve_lxc_root_password: "{{ vault_root_password }}"
        pve_lxc_ostemplate_name: "{{ item.template }}"
        pve_lxc_cpu_cores: "{{ item.cpu_cores }}"
        pve_lxc_memory: "{{ item.memory }}"
        pve_lxc_disk: "{{ item.disk }}"
        pve_lxc_ip_address: "{{ item.ip_address }}"
      loop:
        - hostname: "web-01"
          template: "ubuntu-22.04-standard_22.04-1_amd64.tar.gz"
          cpu_cores: 2
          memory: 1024
          disk: 20
          ip_address: "192.168.1.10"
        - hostname: "db-01"
          template: "debian-11-standard_11.7-1_amd64.tar.gz"
          cpu_cores: 4
          memory: 2048
          disk: 50
          ip_address: "192.168.1.20"
```

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Ç–æ–∫–µ–Ω—É

```yaml
- hosts: proxmox_nodes
  roles:
    - role: proxmox_lxc
      vars:
        pve_api_host: "pve.example.com"
        pve_node: "pve-node-01"
        pve_api_token_id: "automations@pam!ansible"
        pve_api_token_secret: "{{ vault_api_token_secret }}"
        pve_hostname: "secure-container"
        pve_lxc_root_password: "{{ vault_root_password }}"
        pve_lxc_ostemplate_name: "alpine-3.18-standard_3.18.4-1_amd64.tar.gz"
```

## –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ç–∏

```yaml
- hosts: proxmox_nodes
  roles:
    - role: proxmox_lxc
      vars:
        pve_api_host: "pve.example.com"
        pve_node: "pve-node-01"
        pve_hostname: "networked-container"
        pve_lxc_root_password: "{{ vault_root_password }}"
        pve_lxc_ostemplate_name: "debian-11-standard_11.7-1_amd64.tar.gz"
        pve_lxc_net_interfaces:
          - id: net0
            name: eth0
            hwaddr: "02:00:00:00:00:01"
            ip4: "192.168.1.100"
            netmask4: "24"
            gw4: "192.168.1.1"
            bridge: vmbr0
            firewall: true
          - id: net1
            name: eth1
            ip4: "10.0.0.100"
            netmask4: "24"
            bridge: vmbr1
            firewall: false
```

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

```yaml
- hosts: proxmox_nodes
  roles:
    - role: proxmox_lxc
      vars:
        pve_api_host: "pve.example.com"
        pve_node: "pve-node-01"
        pve_hostname: "storage-container"
        pve_lxc_root_password: "{{ vault_root_password }}"
        pve_lxc_ostemplate_name: "debian-11-standard_11.7-1_amd64.tar.gz"
        pve_lxc_mounts:
          - id: mp0
            storage: local-lvm
            size: 100
            mount_point: "/mnt/data"
            acl: true
            quota: false
            backup: true
            read_only: false
          - id: mp1
            storage: nfs-storage
            size: 50
            mount_point: "/mnt/logs"
            acl: false
            quota: true
            backup: false
            read_only: true
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```yaml
- hosts: proxmox_nodes
  roles:
    - role: proxmox_lxc
      vars:
        pve_api_host: "pve.example.com"
        pve_node: "pve-node-01"
        pve_hostname: "featured-container"
        pve_lxc_root_password: "{{ vault_root_password }}"
        pve_lxc_ostemplate_name: "ubuntu-22.04-standard_22.04-1_amd64.tar.gz"
        pve_lxc_features:
          - nesting=1
          - keyctl=1
          - fuse=1
        pve_lxc_hookscript: "local:snippets/vm_hook.sh"
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–†–æ–ª—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏:

### –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ –ª–æ–≥–∞

–§–∞–π–ª –ª–æ–≥–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: `/var/log/ansible-proxmox-lxc.log`

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–∞–π–ª –ª–æ–≥–∞:
```yaml
log_file: "/var/log/custom-proxmox-lxc.log"
```

### –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

| –¢–∏–ø —Å–æ–±—ã—Ç–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------|----------|
| `PACKAGE_INSTALL` | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤ Python |
| `PACKAGE_INSTALL_FAILURE` | –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤ |
| `CONTAINER_CREATION` | –°–æ–∑–¥–∞–Ω–∏–µ LXC –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `CONTAINER_CREATION_FAILURE` | –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ |
| `ROLE_EXECUTION_SUMMARY` | –û–±—â–∞—è —Å–≤–æ–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–æ–ª–∏ |

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞

```json
{
  "timestamp": "2024-01-15T10:30:45.123456Z",
  "level": "INFO",
  "event_type": "CONTAINER_CREATION",
  "service_name": "proxmox_lxc",
  "container_name": "web-server",
  "vmid": "200",
  "changed": true,
  "status": "SUCCESS",
  "user": "ansible",
  "host": "pve-node-01",
  "playbook": "deploy-containers.yml",
  "task": "Create the container",
  "correlation_id": "1705312245",
  "message": "LXC container creation completed",
  "metadata": {
    "api_host": "pve.example.com",
    "node": "pve-node-01",
    "template": "debian-11-standard_11.7-1_amd64.tar.gz",
    "cpu_cores": 2,
    "memory": 1024,
    "disk_size": 20,
    "ip_address": "192.168.1.100",
    "unprivileged": true,
    "onboot": true
  }
}
```

### –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

–í—ã –º–æ–∂–µ—Ç–µ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ —Å –ø–æ–º–æ—â—å—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–µ–¥–∞–≤–Ω–∏—Ö —Å–æ–∑–¥–∞–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
grep "CONTAINER_CREATION" /var/log/ansible-proxmox-lxc.log | tail -10

# –ü–æ–¥—Å—á–µ—Ç —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
grep '"status": "SUCCESS"' /var/log/ansible-proxmox-lxc.log | wc -l

# –ü–æ–∏—Å–∫ –æ—à–∏–±–æ–∫
grep '"level": "ERROR"' /var/log/ansible-proxmox-lxc.log

# –ü–∞—Ä—Å–∏–Ω–≥ —Å jq
cat /var/log/ansible-proxmox-lxc.log | jq '.metadata.container_name'
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–†–æ–ª—å –≤–∫–ª—é—á–∞–µ—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏:

### –ü–∞—Ç—Ç–µ—Ä–Ω Block-Rescue

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–∞—Ç—Ç–µ—Ä–Ω block-rescue:

```yaml
- name: "–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è"
  block:
    - name: "–û—Å–Ω–æ–≤–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è"
      # ... –æ—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ ...
  rescue:
    - name: "–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏"
      # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ ...
    - name: "–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å –¥–µ—Ç–∞–ª—è–º–∏"
      ansible.builtin.fail:
        msg: "–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π."
```

### –õ–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–æ–≤ –¥–ª—è –Ω–µ—É–¥–∞—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:

```yaml
retries: 3
retry_delay: 5
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

–í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º:

```json
{
  "level": "ERROR",
  "event_type": "CONTAINER_CREATION_FAILURE",
  "error_message": "Container creation failed: insufficient resources",
  "error_type": "ProxmoxAPIError",
  "metadata": {
    "api_host": "pve.example.com",
    "node": "pve-node-01",
    "template": "debian-11-standard_11.7-1_amd64.tar.gz"
  }
}
```

## –°–æ–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è–º–∏

- –•—Ä–∞–Ω–∏—Ç–µ –≤—Å–µ –ø–∞—Ä–æ–ª–∏ –≤ Ansible Vault
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `no_log: true` –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á
- –í–∫–ª—é—á–∏—Ç–µ `debug_show_passwords: false` –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Ç–æ–∫–µ–Ω—É

–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞–π—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ —Ç–æ–∫–µ–Ω—É –≤–º–µ—Å—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/–ø–∞—Ä–æ–ª—å:

```yaml
pve_api_token_id: "automations@pam!ansible"
pve_api_token_secret: "{{ vault_api_token_secret }}"
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

–í–∫–ª—é—á–∏—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ:

```yaml
pve_validate_certs: true
```

### –°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ API
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—é —Å–µ—Ç–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ VPN –∏–ª–∏ —á–∞—Å—Ç–Ω—ã–µ —Å–µ—Ç–∏ –¥–ª—è —Å–≤—è–∑–∏ —Å API

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 1. –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ API

**–û—à–∏–±–∫–∞**: `Proxmox API is not reachable`

**–†–µ—à–µ–Ω–∏—è**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Ö–æ—Å—Ç—É Proxmox
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∞–≤–∏–ª–∞ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–∞ —Ä–∞–∑—Ä–µ—à–∞—é—Ç –ø–æ—Ä—Ç 8006
- –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —Ö–æ—Å—Ç API –∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

#### 2. –®–∞–±–ª–æ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω

**–û—à–∏–±–∫–∞**: `Template not found`

**–†–µ—à–µ–Ω–∏—è**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è —à–∞–±–ª–æ–Ω–∞ –∏ –µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —à–∞–±–ª–æ–Ω–æ–≤
- –ó–∞–≥—Ä—É–∑–∏—Ç–µ —à–∞–±–ª–æ–Ω –≤—Ä—É—á–Ω—É—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

#### 3. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–µ—Å—É—Ä—Å–æ–≤

**–û—à–∏–±–∫–∞**: `Insufficient resources`

**–†–µ—à–µ–Ω–∏—è**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã CPU, –ø–∞–º—è—Ç–∏ –∏ –¥–∏—Å–∫–∞
- –£–º–µ–Ω—å—à–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—Å—É—Ä—Å–∞–º
- –û—Å–≤–æ–±–æ–¥–∏—Ç–µ —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ —É–∑–ª–µ

#### 4. –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω

**–û—à–∏–±–∫–∞**: `Permission denied`

**–†–µ—à–µ–Ω–∏—è**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è API
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ —Ç–æ–∫–µ–Ω–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–æ–ª–∏

### –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏

–í–∫–ª—é—á–∏—Ç–µ —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫:

```yaml
debug_mode: true
debug_lang: "both"
debug_show_passwords: false  # –û—Å—Ç–∞–≤—å—Ç–µ false –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
```

### –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ—à–∏–±–∫–∞—Ö:

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–µ–¥–∞–≤–Ω–∏—Ö –æ—à–∏–±–æ–∫
grep '"level": "ERROR"' /var/log/ansible-proxmox-lxc.log | tail -5

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º
grep '"container_name": "web-server"' /var/log/ansible-proxmox-lxc.log
```

## –£—á–∞—Å—Ç–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç—ã —Å Molecule
4. –°–ª–µ–¥—É–π—Ç–µ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º Ansible

### –°—Ç–∏–ª—å –∫–æ–¥–∞

- –°–ª–µ–¥—É–π—Ç–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º –ø–æ —Å—Ç–∏–ª—é Ansible
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ FQCN –¥–ª—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
- –í–∫–ª—é—á–∞–π—Ç–µ –¥–≤—É—è–∑—ã—á–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π/—Ä—É—Å—Å–∫–∏–π)
- –î–æ–±–∞–≤–ª—è–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ Molecule
molecule test

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
molecule test -s default
```

### Pull Requests

1. –§–æ—Ä–∫–Ω–∏—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ—Ç–∫—É —Ñ—É–Ω–∫—Ü–∏–∏
3. –í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å —Ç–µ—Å—Ç–∞–º–∏
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ pull request —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - —Å–º. —Ñ–∞–π–ª LICENSE –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏ –≤–æ–ø—Ä–æ—Å–æ–≤:

- –°–æ–∑–¥–∞–π—Ç–µ issue –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- –ò–∑—É—á–∏—Ç–µ —Ä–∞–∑–¥–µ–ª —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫
- –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ Mad-Axell [mad.axell@gmail.com]
